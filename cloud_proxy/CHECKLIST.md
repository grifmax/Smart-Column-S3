# Чек-лист развертывания на Railway.app

## Подготовка

- [ ] Есть GitHub аккаунт
- [ ] Репозиторий Smart-Column-S3 загружен в GitHub
- [ ] Папка `cloud_proxy` существует в репозитории

## Регистрация

- [ ] Открыл https://railway.app
- [ ] Нажал "Login"
- [ ] Выбрал "Login with GitHub"
- [ ] Авторизовал Railway доступ к GitHub
- [ ] Попал в панель управления Railway

## Создание проекта

- [ ] Нажал "New Project"
- [ ] Выбрал "Deploy from GitHub repo"
- [ ] Выбрал репозиторий Smart-Column-S3
- [ ] Указал Root Directory: `cloud_proxy`
- [ ] Проверил, что Framework = Node.js
- [ ] Нажал "Deploy"

## Переменные окружения

- [ ] Открыл Settings → Variables
- [ ] Сгенерировал первый токен (32 символа)
- [ ] Добавил переменную:
  - Name: `ESP32_TOKEN`
  - Value: первый токен
- [ ] Сгенерировал второй токен (32 символа, другой!)
- [ ] Добавил переменную:
  - Name: `CLIENT_TOKEN`
  - Value: второй токен
- [ ] Проверил, что обе переменные добавлены
- [ ] Дождался перезапуска сервера (30-60 сек)

## Получение URL

- [ ] Открыл Settings → Networking
- [ ] Нажал "Generate Domain"
- [ ] Скопировал URL (например: `smart-column-proxy-production.up.railway.app`)
- [ ] Сохранил URL в безопасном месте

## Проверка работы

- [ ] Открыл в браузере: `https://your-url.railway.app/health`
- [ ] Увидел JSON: `{"status":"ok",...}`
- [ ] Проверил логи (Deployments → View Logs)
- [ ] Увидел: "Server running on port 3000"

## Настройка Android приложения

- [ ] Открыл приложение → Настройки устройства
- [ ] Включил переключатель "Облачный прокси"
- [ ] Ввел Хост: URL из Railway
- [ ] Ввел Device ID: `esp32-001` (или другой уникальный)
- [ ] Ввел Токен прокси: `CLIENT_TOKEN` (из шага переменных)
- [ ] Нажал "Проверить подключение"
- [ ] Увидел "Подключение успешно"
- [ ] Нажал "Сохранить"

## Настройка ESP32

- [ ] Добавил код подключения к прокси (см. ESP32_INTEGRATION.md)
- [ ] Указал URL прокси в настройках ESP32
- [ ] Указал Device ID (должен совпадать с приложением!)
- [ ] Указал ESP32_TOKEN (из шага переменных)
- [ ] Проверил подключение ESP32 к прокси
- [ ] Увидел в логах Railway: "[ESP32] Device connected"

## Финальная проверка

- [ ] ESP32 подключен к прокси (логи Railway)
- [ ] Android приложение подключено к прокси
- [ ] Вижу данные от ESP32 в приложении
- [ ] Могу управлять устройством из приложения
- [ ] Работает из любой точки мира (не только локальная сеть)

---

## ✅ Готово!

Если все пункты отмечены - удаленный доступ настроен и работает!

---

## Полезные ссылки

- Логи Railway: Deployments → View Logs
- Переменные: Settings → Variables
- URL: Settings → Networking
- Документация: [RAILWAY_STEP_BY_STEP.md](RAILWAY_STEP_BY_STEP.md)

