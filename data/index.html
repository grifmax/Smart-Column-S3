<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart-Column S3</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="column-animation.css">
    <link rel="stylesheet" href="schemes-animation.css">
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>

<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <header>
            <h1>üè≠ Smart-Column S3</h1>
            <div class="status-bar">
                <span id="connection-status" class="status-dot offline">‚óè</span>
                <span id="connection-text">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span>
                <span class="uptime">Uptime: <span id="uptime">--:--:--</span></span>
                <div class="user-menu-container" data-cloud-only="1" style="position: relative; margin-left: 15px;">
                    <span class="user-info" id="user-info" style="color: var(--text-secondary); font-size: 0.9em; cursor: pointer; user-select: none;" onclick="toggleUserMenu()">
                        üë§ <span id="current-username">–ó–∞–≥—Ä—É–∑–∫–∞...</span> ‚ñº
                    </span>
                    <div id="user-menu" class="user-menu" style="display: none; position: absolute; top: 100%; right: 0; background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 4px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-top: 5px; min-width: 150px; z-index: 1000;">
                        <div class="user-menu-item" onclick="switchAccount()" style="padding: 10px 15px; cursor: pointer; border-bottom: 1px solid var(--border-color);">
                            üîÑ –°–º–µ–Ω–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç
                        </div>
                        <div class="user-menu-item" onclick="logout()" style="padding: 10px 15px; cursor: pointer; color: var(--danger, #dc3545);">
                            üö™ –í—ã—Ö–æ–¥
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="tabs">
            <button class="tab active" data-tab="monitor">üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</button>
            <button class="tab" data-tab="control">üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
            <button class="tab" data-tab="settings">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <button class="tab" data-tab="logs">üìù –õ–æ–≥–∏</button>
            <button class="tab" data-tab="history">üìö –ò—Å—Ç–æ—Ä–∏—è</button>
            <button class="tab" data-tab="profiles">üìÅ –ü—Ä–æ—Ñ–∏–ª–∏</button>
            <a href="charts.html" class="tab" style="text-decoration: none;">üìà –ì—Ä–∞—Ñ–∏–∫–∏</a>
            <a href="manual.html" class="tab" style="text-decoration: none;">üîß –†—É—á–Ω–æ–π —Ä–µ–∂–∏–º</a>
            <a href="calibration.html" class="tab" style="text-decoration: none;">‚öôÔ∏è –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</a>
            <a href="wifi.html" class="tab" style="text-decoration: none;">üì∂ WiFi</a>
        </nav>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ -->
        <div id="monitor" class="tab-content active">
            <div class="cards">
                <!-- –†–µ–∂–∏–º –∏ —Ñ–∞–∑–∞ -->
                <div class="card">
                    <h2>–°—Ç–∞—Ç—É—Å</h2>
                    <div class="big-value">
                        <div class="label">–†–µ–∂–∏–º</div>
                        <div id="mode" class="value mode-idle">IDLE</div>
                    </div>
                    <div class="big-value">
                        <div class="label">–§–∞–∑–∞</div>
                        <div id="phase" class="value">‚Äî</div>
                    </div>
                </div>

                <!-- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã -->
                <div class="card">
                    <h2>üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</h2>
                    <div class="metrics">
                        <div class="metric">
                            <span class="metric-label">–ö—É–±</span>
                            <span id="temp-cube" class="metric-value">--¬∞C</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–¶–∞—Ä–≥–∞ –Ω–∏–∑</span>
                            <span id="temp-column-bottom" class="metric-value">--¬∞C</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–¶–∞—Ä–≥–∞ –≤–µ—Ä—Ö</span>
                            <span id="temp-column-top" class="metric-value">--¬∞C</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–î–µ—Ñ–ª–µ–≥–º–∞—Ç–æ—Ä</span>
                            <span id="temp-reflux" class="metric-value">--¬∞C</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–¢–°–ê</span>
                            <span id="temp-tsa" class="metric-value">--¬∞C</span>
                        </div>
                    </div>
                </div>

                <!-- –î–∞–≤–ª–µ–Ω–∏–µ -->
                <div class="card">
                    <h2>üìà –î–∞–≤–ª–µ–Ω–∏–µ</h2>
                    <div class="metrics">
                        <div class="metric">
                            <span class="metric-label">–ö—É–±</span>
                            <span id="pressure-cube" class="metric-value">-- –º–º —Ä—Ç.—Å—Ç.</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ</span>
                            <span id="pressure-atm" class="metric-value">-- –≥–ü–∞</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–ü–æ—Ä–æ–≥ –∑–∞—Ö–ª—ë–±–∞</span>
                            <span id="pressure-flood" class="metric-value">-- –º–º</span>
                        </div>
                    </div>
                </div>

                <!-- –ú–æ—â–Ω–æ—Å—Ç—å -->
                <div class="card">
                    <h2>‚ö° –≠–ª–µ–∫—Ç—Ä–æ–ø–∏—Ç–∞–Ω–∏–µ (PZEM-004T)</h2>
                    <div class="metrics">
                        <div class="metric">
                            <span class="metric-label">–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ</span>
                            <span id="power-voltage" class="metric-value">-- V</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–¢–æ–∫</span>
                            <span id="power-current" class="metric-value">-- A</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–ú–æ—â–Ω–æ—Å—Ç—å</span>
                            <span id="power-power" class="metric-value">-- W</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–≠–Ω–µ—Ä–≥–∏—è</span>
                            <span id="power-energy" class="metric-value">-- –∫–í—Ç¬∑—á</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–ß–∞—Å—Ç–æ—Ç–∞</span>
                            <span id="power-frequency" class="metric-value">-- –ì—Ü</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–ö–æ—ç—Ñ—Ñ. –º–æ—â–Ω–æ—Å—Ç–∏</span>
                            <span id="power-pf" class="metric-value">--</span>
                        </div>
                    </div>
                </div>

                <!-- –ù–∞—Å–æ—Å –∏ –æ—Ç–±–æ—Ä -->
                <div class="card">
                    <h2>üíß –ù–∞—Å–æ—Å –∏ –æ—Ç–±–æ—Ä</h2>
                    <div class="metrics">
                        <div class="metric">
                            <span class="metric-label">–°–∫–æ—Ä–æ—Å—Ç—å</span>
                            <span id="pump-speed" class="metric-value">-- –º–ª/—á</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–û–±—ä—ë–º</span>
                            <span id="pump-volume" class="metric-value">-- –º–ª</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–ì–æ–ª–æ–≤—ã</span>
                            <span id="volume-heads" class="metric-value">-- –º–ª</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–¢–µ–ª–æ</span>
                            <span id="volume-body" class="metric-value">-- –º–ª</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">–•–≤–æ—Å—Ç—ã</span>
                            <span id="volume-tails" class="metric-value">-- –º–ª</span>
                        </div>
                    </div>
                </div>

                <!-- –ê—Ä–µ–æ–º–µ—Ç—Ä -->
                <div class="card">
                    <h2>üç∑ –ê—Ä–µ–æ–º–µ—Ç—Ä</h2>
                    <div class="big-value">
                        <div class="label">–ö—Ä–µ–ø–æ—Å—Ç—å</div>
                        <div id="abv" class="value">--%</div>
                    </div>
                </div>

                <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –∫–æ–ª–æ–Ω–Ω—ã -->
                <div class="card">
                    <h2>üè≠ –°—Ö–µ–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞</h2>
                    <div class="scheme-container" style="display: flex; justify-content: center; padding: 10px;">
                        <object data="schemes/column-animated.svg" type="image/svg+xml"
                            style="width: 100%; max-width: 500px; height: auto;"></object>
                    </div>
                </div>

                <!-- –ú–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä -->
                <div class="card">
                    <h2>üìà –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (5 –º–∏–Ω)</h2>
                    <div id="mini-chart" style="width: 100%; height: 200px;"></div>
                    <div style="text-align: center; margin-top: 10px;">
                        <a href="charts.html" class="btn btn-primary btn-sm">üìä –í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
        <div id="control" class="tab-content">
            <div class="cards">
                <div class="card">
                    <h2>–ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞</h2>
                    <div class="controls">
                        <button class="btn btn-success" onclick="startRectification()">‚ñ∂Ô∏è –ê–≤—Ç–æ-—Ä–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</button>
                        <button class="btn btn-warning" onclick="startManual()">üéõÔ∏è –†—É—á–Ω–∞—è —Ä–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</button>
                        <button class="btn btn-info" onclick="startDistillation()">üè∫ –î–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è</button>
                    </div>
                    <div class="controls">
                        <button class="btn btn-danger" onclick="stopProcess()">‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                        <button class="btn" onclick="pauseProcess()">‚è∏Ô∏è –ü–∞—É–∑–∞</button>
                        <button class="btn" onclick="resumeProcess()">‚èØÔ∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
                    </div>
                </div>

                <div class="card">
                    <h2>–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h2>
                    <div class="control-group">
                        <label for="heater-power">–ú–æ—â–Ω–æ—Å—Ç—å –Ω–∞–≥—Ä–µ–≤–∞: <span id="heater-value">0</span> –í—Ç</label>
                        <input type="range" id="heater-power" min="0" max="5500" step="50" value="0"
                            oninput="updateHeater(this.value)">
                    </div>
                    <div class="control-group">
                        <label for="pump-speed-control">–°–∫–æ—Ä–æ—Å—Ç—å –Ω–∞—Å–æ—Å–∞: <span id="pump-value">0</span> –º–ª/—á</label>
                        <input type="range" id="pump-speed-control" min="0" max="500" value="0"
                            oninput="updatePump(this.value)">
                    </div>
                    <div class="control-group">
                        <label>–ö–ª–∞–ø–∞–Ω—ã</label>
                        <div class="controls">
                            <button class="btn btn-sm" onclick="toggleValve('water')">üíß –í–æ–¥–∞</button>
                            <button class="btn btn-sm" onclick="toggleValve('heads')">ü•É –ì–æ–ª–æ–≤—ã</button>
                            <button class="btn btn-sm" onclick="toggleValve('uno')">üîÑ –£–ù–û</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div id="settings" class="tab-content">
            <div class="cards">
                <!-- –î–µ–º–æ-—Ä–µ–∂–∏–º -->
                <div class="card"
                    style="border: 2px solid var(--warning, #ffc107); background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 193, 7, 0.05));">
                    <h2>üß™ –î–µ–º–æ-—Ä–µ–∂–∏–º</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 15px;">
                        –°–∏–º—É–ª—è—Ü–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤ –∏
                        –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.
                    </p>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="demo-mode-enabled" onchange="toggleDemoMode()">
                            <span style="font-weight: 600;">–í–∫–ª—é—á–∏—Ç—å –¥–µ–º–æ-—Ä–µ–∂–∏–º</span>
                        </label>
                    </div>
                    <small style="color: var(--warning, #856404); display: block; margin-top: 10px;">
                        ‚ö†Ô∏è –í –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –≤—Å–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ. –†–µ–∞–ª—å–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω–µ
                        —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è.
                    </small>
                </div>

                <!-- –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ -->
                <div class="card"
                    style="border: 2px solid var(--danger, #dc3545); background: linear-gradient(135deg, rgba(220, 53, 69, 0.1), rgba(220, 53, 69, 0.05));">
                    <h2>üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 15px;">
                        –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ ESP32. –í—Å–µ —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –±—É–¥—É—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã.
                    </p>
                    <button class="btn btn-danger" onclick="rebootController()" style="width: 100%; padding: 12px;">
                        üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
                    </button>
                    <small style="color: var(--danger, #dc3545); display: block; margin-top: 10px;">
                        ‚ö†Ô∏è –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±—É–¥–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.
                    </small>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ESP32 -->
                <div class="card" data-cloud-only="1" style="border: 2px solid var(--primary, #007bff); background: linear-gradient(135deg, rgba(0, 123, 255, 0.1), rgba(0, 123, 255, 0.05));">
                    <h2>üì° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ESP32</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 15px;">
                        –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É ESP32. –ï—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ, –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ.
                    </p>
                    
                    <div class="form-group">
                        <label>–í—ã–±–µ—Ä–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</label>
                        <select id="esp32-device-select" style="width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; background: var(--bg-secondary); color: var(--text-primary); margin-bottom: 10px;" onchange="loadESP32Device()">
                            <option value="">–ó–∞–≥—Ä—É–∑–∫–∞...</option>
                        </select>
                        <button class="btn btn-success" onclick="showAddDeviceForm()" style="width: 100%;">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
                        </button>
                    </div>
                    
                    <div id="esp32-device-form" style="display: none;">
                        <div class="form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</label>
                            <input type="text" id="esp32-device-name" placeholder="–ö—É—Ö–Ω—è, –ì–∞—Ä–∞–∂ –∏ —Ç.–¥.">
                        </div>
                        
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="esp32-enabled" onchange="toggleESP32Fields()">
                                <span style="font-weight: 600;">–í–∫–ª—é—á–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ESP32</span>
                            </label>
                        </div>
                        
                        <div id="esp32-fields" style="display: none;">
                            <div class="form-group">
                                <label>–ê–¥—Ä–µ—Å ESP32</label>
                                <input type="text" id="esp32-host" placeholder="192.168.1.100 –∏–ª–∏ esp32.local">
                                <small style="color: var(--text-secondary); display: block; margin-top: 5px;">
                                    IP-–∞–¥—Ä–µ—Å –∏–ª–∏ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ESP32
                                </small>
                            </div>
                            
                            <div class="form-group">
                                <label>–ü–æ—Ä—Ç</label>
                                <input type="number" id="esp32-port" value="80" min="1" max="65535">
                            </div>
                            
                            <div class="form-group">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="esp32-use-https">
                                    <span>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS</span>
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                                <input type="text" id="esp32-username" placeholder="admin">
                                <small style="color: var(--text-secondary); display: block; margin-top: 5px;">
                                    –ï—Å–ª–∏ –Ω–∞ ESP32 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ HTTP Basic Authentication
                                </small>
                            </div>
                            
                            <div class="form-group">
                                <label>–ü–∞—Ä–æ–ª—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                                <input type="password" id="esp32-password" placeholder="–ø–∞—Ä–æ–ª—å">
                            </div>
                            
                            <div class="form-group">
                                <label>–¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—Å–µ–∫)</label>
                                <input type="number" id="esp32-timeout" value="5" min="1" max="30">
                            </div>
                            
                            <div style="display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap;">
                                <button class="btn btn-primary" onclick="saveESP32Device()" style="flex: 1; min-width: 150px;">
                                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                                </button>
                                <button class="btn" onclick="testESP32Connection()" style="flex: 1; min-width: 150px;">
                                    üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                                </button>
                                <button class="btn btn-warning" id="esp32-activate-btn" onclick="activateESP32Device()" style="flex: 1; min-width: 150px; display: none;">
                                    ‚≠ê –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–º
                                </button>
                                <button class="btn btn-danger" id="esp32-delete-btn" onclick="deleteESP32Device()" style="flex: 1; min-width: 150px; display: none;">
                                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </div>
                            
                            <div id="esp32-test-result" style="margin-top: 10px; padding: 10px; border-radius: 5px; display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>üì∂ WiFi</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 15px;">
                        –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
                        —Å–µ—Ç–µ–π –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.
                    </p>
                    <a href="wifi.html" class="btn btn-primary"
                        style="text-decoration: none; display: inline-block; padding: 10px 20px;">
                        üì∂ –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WiFi
                    </a>
                </div>

                <div class="card">
                    <h2>üì° MQTT</h2>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="mqtt-enabled" onchange="toggleMqttFields()">
                            <span>–í–∫–ª—é—á–∏—Ç—å MQTT</span>
                        </label>
                    </div>
                    <div id="mqtt-fields">
                        <div class="form-group">
                            <label>–°–µ—Ä–≤–µ—Ä MQTT</label>
                            <input type="text" id="mqtt-server" placeholder="192.168.1.50 –∏–ª–∏ homeassistant.local">
                        </div>
                        <div class="form-group">
                            <label>–ü–æ—Ä—Ç</label>
                            <input type="number" id="mqtt-port" value="1883" min="1" max="65535">
                        </div>
                        <div class="form-group">
                            <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                            <input type="text" id="mqtt-username" placeholder="mqtt_user">
                        </div>
                        <div class="form-group">
                            <label>–ü–∞—Ä–æ–ª—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                            <input type="password" id="mqtt-password" placeholder="–ø–∞—Ä–æ–ª—å">
                        </div>
                        <div class="form-group">
                            <label>–ë–∞–∑–æ–≤—ã–π —Ç–æ–ø–∏–∫</label>
                            <input type="text" id="mqtt-base-topic" value="smartcolumn">
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="mqtt-discovery" checked>
                                <span>Home Assistant Discovery</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label>–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (–º—Å)</label>
                            <input type="number" id="mqtt-publish-interval" value="10000" min="1000" max="60000"
                                step="1000">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="saveMqtt()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>

                <div class="card">
                    <h2>üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h2>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="auth-enabled" onchange="toggleAuthFields()">
                            <span>–í–∫–ª—é—á–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é</span>
                        </label>
                    </div>
                    <div id="auth-fields">
                        <div class="form-group">
                            <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                            <input type="text" id="web-username" value="admin">
                        </div>
                        <div class="form-group">
                            <label>–ü–∞—Ä–æ–ª—å</label>
                            <input type="password" id="web-password" placeholder="–Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å">
                        </div>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="rate-limit-enabled" checked>
                            <span>Rate Limiting (60 req/min)</span>
                        </label>
                    </div>
                    <button class="btn btn-primary" onclick="saveSecurity()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>

                <div class="card">
                    <h2>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</h2>

                    <h3 style="margin-top: 0; color: var(--text-secondary); font-size: 0.95em;">üíß –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –Ω–∞—Å–æ—Å–∞
                    </h3>
                    <div class="form-group">
                        <label>–º–ª –Ω–∞ –æ–±–æ—Ä–æ—Ç</label>
                        <input type="number" id="pump-ml-per-rev" step="0.001" min="0" placeholder="–ó–∞–≥—Ä—É–∑–∫–∞...">
                        <small style="color: var(--text-secondary); display: block; margin-top: 5px;">
                            –û–±—ä—ë–º –∂–∏–¥–∫–æ—Å—Ç–∏ –∑–∞ –æ–¥–∏–Ω –ø–æ–ª–Ω—ã–π –æ–±–æ—Ä–æ—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—è –Ω–∞—Å–æ—Å–∞
                        </small>
                    </div>
                    <div class="form-group">
                        <label>–®–∞–≥–æ–≤ –∑–∞ –ø–æ–ª–Ω—ã–π –æ–±–æ—Ä–æ—Ç</label>
                        <input type="number" id="pump-steps-per-rev" min="1" step="1" placeholder="–ó–∞–≥—Ä—É–∑–∫–∞...">
                        <small style="color: var(--text-secondary); display: block; margin-top: 5px;">
                            –°–ø—Ä–∞–≤–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ (—à–∞–≥–∏ √ó –º–∏–∫—Ä–æ—à–∞–≥–∏)
                        </small>
                    </div>

                    <hr style="margin: 20px 0; border-color: var(--border);">

                    <h3 style="margin-top: 0; color: var(--text-secondary); font-size: 0.95em;">‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
                        –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</h3>
                    <div class="form-group">
                        <label>–ú–æ—â–Ω–æ—Å—Ç—å –¢–≠–ù–∞ (–í—Ç)</label>
                        <input type="number" id="heater-power-w" value="3000" min="1000" max="10000">
                    </div>
                    <div class="form-group">
                        <label>–í—ã—Å–æ—Ç–∞ —Ü–∞—Ä–≥–∏ (–º–º)</label>
                        <input type="number" id="column-height" value="1500" min="500" max="3000">
                    </div>
                    <button class="btn btn-primary" onclick="saveEquipment()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>

                <div class="card">
                    <h2>–¢–µ–º–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</h2>
                    <div class="controls">
                        <button class="btn" onclick="setTheme('light')">‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è</button>
                        <button class="btn" onclick="setTheme('dark')">üåô –¢—ë–º–Ω–∞—è</button>
                    </div>
                </div>

                <div class="card">
                    <h2>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏—è—Ö</h2>

                    <h3 style="margin-top: 0; color: var(--text-secondary); font-size: 0.95em;">üì± –ü—Ä–æ—à–∏–≤–∫–∞ (Backend)
                    </h3>
                    <div
                        style="background: var(--bg-secondary); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <div style="display: grid; grid-template-columns: auto 1fr; gap: 10px; font-size: 14px;">
                            <strong>–í–µ—Ä—Å–∏—è:</strong>
                            <span id="firmware-version">–ó–∞–≥—Ä—É–∑–∫–∞...</span>

                            <strong>–î–∞—Ç–∞ —Å–±–æ—Ä–∫–∏:</strong>
                            <span id="firmware-build-date">–ó–∞–≥—Ä—É–∑–∫–∞...</span>

                            <strong>–í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏:</strong>
                            <span id="firmware-build-time">–ó–∞–≥—Ä—É–∑–∫–∞...</span>

                            <strong>–ü–ª–∞—Ç–∞:</strong>
                            <span id="board-chip">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                    </div>

                    <h3 style="color: var(--text-secondary); font-size: 0.95em;">üåê –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Frontend)</h3>
                    <div style="background: var(--bg-secondary); padding: 15px; border-radius: 8px;">
                        <div style="display: grid; grid-template-columns: auto 1fr; gap: 10px; font-size: 14px;">
                            <strong>–î–∞—Ç–∞ —Å–±–æ—Ä–∫–∏:</strong>
                            <span id="frontend-build-date">–ó–∞–≥—Ä—É–∑–∫–∞...</span>

                            <strong>–í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏:</strong>
                            <span id="frontend-build-time">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                    </div>

                    <button class="btn btn-secondary" onclick="loadVersionInfo()" style="margin-top: 15px;">üîÑ
                        –û–±–Ω–æ–≤–∏—Ç—å</button>
                </div>

                <div class="card">
                    <h2>–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h2>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="show-memory-stats" onchange="toggleMemoryStats()">
                            <span>–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–∞–º—è—Ç–∏ –≤ —Ñ—É—Ç–µ—Ä–µ</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –õ–æ–≥–∏ -->
        <div id="logs" class="tab-content">
            <div class="card">
                <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è</h2>
                <div id="log-container" class="log-container">
                    <div class="log-entry">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–∏—Å—Ç–µ–º–µ...</div>
                </div>
                <button class="btn" onclick="clearLogs()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                <button class="btn btn-primary" onclick="downloadLogs()">üíæ –°–∫–∞—á–∞—Ç—å CSV</button>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ò—Å—Ç–æ—Ä–∏—è -->
        <div id="history" class="tab-content">
            <div class="card">
                <h2>üìö –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</h2>

                <!-- –§–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫ -->
                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <select id="history-filter-type" onchange="loadHistoryList()">
                        <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
                        <option value="rectification">–†–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</option>
                        <option value="distillation">–î–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è</option>
                        <option value="mashing">–ó–∞—Ç–∏—Ä–∫–∞</option>
                    </select>
                    <select id="history-filter-status" onchange="loadHistoryList()">
                        <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                        <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</option>
                        <option value="stopped">–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ</option>
                        <option value="error">–û—à–∏–±–∫–∞</option>
                    </select>
                    <button class="btn btn-primary" onclick="loadHistoryList()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                    <button id="compare-processes-btn" class="btn btn-primary" onclick="compareSelected()" disabled>üìä
                        –°—Ä–∞–≤–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ (0)</button>
                    <button class="btn" onclick="clearHistory()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
                </div>

                <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ -->
                <div id="history-list" class="history-list">
                    <p class="info-text">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤...</p>
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                <div style="margin-top: 20px; padding: 15px; background: var(--bg-primary); border-radius: 6px;">
                    <h3 style="margin-top: 0;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <div style="color: var(--text-secondary); font-size: 0.9em;">–í—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</div>
                            <div style="font-size: 1.5em; font-weight: 600;" id="hist-stat-total">0</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary); font-size: 0.9em;">–£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                            <div style="font-size: 1.5em; font-weight: 600; color: #4CAF50;" id="hist-stat-completed">0
                            </div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary); font-size: 0.9em;">–û–±—â–µ–µ –≤—Ä–µ–º—è</div>
                            <div style="font-size: 1.5em; font-weight: 600;" id="hist-stat-time">0 —á</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary); font-size: 0.9em;">–≠–Ω–µ—Ä–≥–∏—è</div>
                            <div style="font-size: 1.5em; font-weight: 600;" id="hist-stat-energy">0 –∫–í—Ç¬∑—á</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ü—Ä–æ—Ñ–∏–ª–∏ -->
        <div id="profiles" class="tab-content">
            <div class="card">
                <h2>üìÅ –ü—Ä–æ—Ñ–∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ–¥ –∏–º–µ–Ω–µ–º –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
                    –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã –ø–æ–º–æ–≥—É—Ç –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –≥–æ—Ç–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.
                </p>

                <!-- –î–µ–π—Å—Ç–≤–∏—è -->
                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <select id="profile-filter-category" onchange="loadProfilesList()">
                        <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        <option value="rectification">–†–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</option>
                        <option value="distillation">–î–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è</option>
                        <option value="mashing">–ó–∞—Ç–∏—Ä–∫–∞</option>
                    </select>
                    <button class="btn btn-primary" onclick="loadProfilesList()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                    <button class="btn btn-success" onclick="showCreateProfileModal()">‚ûï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
                    <button class="btn" onclick="exportAllProfiles()">üì§ –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö</button>
                    <button class="btn" onclick="showImportModal()">üì• –ò–º–ø–æ—Ä—Ç</button>
                    <button class="btn" onclick="clearUserProfiles()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ</button>
                </div>

                <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–æ—Ñ–∏–ª–µ–π -->
                <div id="profiles-list" class="profiles-list">
                    <p class="info-text">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π...</p>
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                <div style="margin-top: 20px; padding: 15px; background: var(--bg-primary); border-radius: 6px;">
                    <h3 style="margin-top: 0;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <div style="color: var(--text-secondary); font-size: 0.9em;">–í—Å–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª–µ–π</div>
                            <div style="font-size: 1.5em; font-weight: 600;" id="prof-stat-total">0</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary); font-size: 0.9em;">–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤</div>
                            <div style="font-size: 1.5em; font-weight: 600; color: #2196F3;" id="prof-stat-builtin">0
                            </div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary); font-size: 0.9em;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö</div>
                            <div style="font-size: 1.5em; font-weight: 600; color: #4CAF50;" id="prof-stat-user">0</div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary); font-size: 0.9em;">–°–∞–º—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π</div>
                            <div style="font-size: 1.1em; font-weight: 600;" id="prof-stat-popular">‚Äî</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –§—É—Ç–µ—Ä -->
        <footer>
            <p>Smart-Column S3 v1.4.11 | ESP32-S3 DevKitC-1 N16R8</p>
            <div id="memory-stats"
                style="display: none; margin-top: 10px; font-size: 0.75em; color: var(--text-secondary); line-height: 1.4;">
                <div style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">
                    <span>üíæ SRAM: <span id="mem-heap-used">--</span> / <span id="mem-heap-total">--</span> (<span
                            id="mem-heap-pct">--%</span>)</span>
                    <span>üß† PSRAM: <span id="mem-psram-free">--</span> / <span id="mem-psram-total">--</span></span>
                    <span>üì¶ Flash: <span id="mem-flash-pct">--%</span></span>
                </div>
            </div>
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ -->
    <div id="history-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modal-title">–î–µ—Ç–∞–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞</div>
                <button class="modal-close" onclick="closeHistoryModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                <div class="modal-section">
                    <div class="modal-section-title">üìã –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                    <div class="modal-info-grid" id="modal-info-grid">
                        <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
                    </div>
                </div>

                <!-- –ì—Ä–∞—Ñ–∏–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä -->
                <div class="modal-section">
                    <div class="modal-section-title">üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</div>
                    <div class="modal-chart">
                        <div id="modal-temp-chart"></div>
                    </div>
                </div>

                <!-- –ì—Ä–∞—Ñ–∏–∫ –º–æ—â–Ω–æ—Å—Ç–∏ -->
                <div class="modal-section">
                    <div class="modal-section-title">‚ö° –ú–æ—â–Ω–æ—Å—Ç—å</div>
                    <div class="modal-chart">
                        <div id="modal-power-chart"></div>
                    </div>
                </div>

                <!-- –§–∞–∑—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ -->
                <div class="modal-section">
                    <div class="modal-section-title">‚è±Ô∏è –§–∞–∑—ã –ø—Ä–æ—Ü–µ—Å—Å–∞</div>
                    <div class="modal-phases" id="modal-phases">
                        <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
                    </div>
                </div>

                <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
                <div class="modal-section">
                    <div class="modal-section-title">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</div>
                    <div class="modal-info-grid" id="modal-results-grid">
                        <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
                    </div>
                </div>

                <!-- –î–µ–π—Å—Ç–≤–∏—è —Å –ø—Ä–æ—Ü–µ—Å—Å–æ–º -->
                <div class="modal-section">
                    <div class="modal-section-title">üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn-primary" id="modal-export-csv" style="flex: 1; min-width: 150px;">
                            üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
                        </button>
                        <button class="btn-primary" id="modal-export-json" style="flex: 1; min-width: 150px;">
                            üìÑ –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ -->
    <div id="compare-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 1400px;">
            <div class="modal-header">
                <div class="modal-title" id="compare-modal-title">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤</div>
                <button class="modal-close" onclick="closeCompareModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- –°–ø–∏—Å–æ–∫ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ -->
                <div class="modal-section">
                    <div class="modal-section-title">üìã –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã</div>
                    <div id="compare-process-list"
                        style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px;">
                        <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
                    </div>
                </div>

                <!-- –ì—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä -->
                <div class="modal-section">
                    <div class="modal-section-title">üå°Ô∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä (–∫—É–±)</div>
                    <div class="modal-chart">
                        <div id="compare-temp-chart"></div>
                    </div>
                </div>

                <!-- –ì—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ—â–Ω–æ—Å—Ç–∏ -->
                <div class="modal-section">
                    <div class="modal-section-title">‚ö° –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ—â–Ω–æ—Å—Ç–∏</div>
                    <div class="modal-chart">
                        <div id="compare-power-chart"></div>
                    </div>
                </div>

                <!-- –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ -->
                <div class="modal-section">
                    <div class="modal-section-title">üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞</div>
                    <div id="compare-table" style="overflow-x: auto;">
                        <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
    <div id="profile-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <div class="modal-title" id="profile-modal-title">–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</div>
                <button class="modal-close" onclick="closeProfileModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ -->
                <div class="modal-section">
                    <div class="modal-section-title">üìù –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: 500;">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
                                *</label>
                            <input type="text" id="profile-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°–∞—Ö–∞—Ä–Ω–∞—è –±—Ä–∞–≥–∞ 40%"
                                maxlength="50"
                                style="width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; background: var(--bg-secondary); color: var(--text-primary);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: 500;">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea id="profile-description" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è..." maxlength="200"
                                rows="3"
                                style="width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; background: var(--bg-secondary); color: var(--text-primary); resize: vertical;"></textarea>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: 500;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                            <select id="profile-category"
                                style="width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; background: var(--bg-secondary); color: var(--text-primary);">
                                <option value="rectification">–†–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</option>
                                <option value="distillation">–î–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è</option>
                                <option value="mashing">–ó–∞—Ç–∏—Ä–∫–∞ —Å–æ–ª–æ–¥–∞</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: 500;">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑
                                –∑–∞–ø—è—Ç—É—é)</label>
                            <input type="text" id="profile-tags" placeholder="—Å–∞—Ö–∞—Ä, –∫–ª–∞—Å—Å–∏–∫–∞, 40%"
                                style="width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; background: var(--bg-secondary); color: var(--text-primary);">
                        </div>
                    </div>
                </div>

                <!-- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ -->
                <div class="modal-section">
                    <div class="modal-section-title">‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã</div>
                    <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: -10px; margin-bottom: 15px;">
                        –ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑ –≤–∫–ª–∞–¥–∫–∏ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
                    </p>
                    <div style="background: var(--bg-primary); padding: 10px; border-radius: 4px; font-size: 0.9em;">
                        ‚ÑπÔ∏è –ë—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: –º–æ—â–Ω–æ—Å—Ç—å –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è, –æ–±—ä–µ–º—ã —Ñ—Ä–∞–∫—Ü–∏–π, —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–±–æ—Ä–∞, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –ø–æ—Ä–æ–≥–∏,
                        –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeProfileModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-success" onclick="saveProfile()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
    <div id="profile-view-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title" id="profile-view-title">–î–µ—Ç–∞–ª–∏ –ø—Ä–æ—Ñ–∏–ª—è</div>
                <button class="modal-close" onclick="closeProfileViewModal()">&times;</button>
            </div>
            <div class="modal-body" id="profile-view-body">
                <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeProfileViewModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" onclick="loadProfileToSettings()">üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π -->
    <div id="profile-import-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <div class="modal-title">üì• –ò–º–ø–æ—Ä—Ç –ø—Ä–æ—Ñ–∏–ª–µ–π</div>
                <button class="modal-close" onclick="closeImportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p style="color: var(--text-secondary); margin-bottom: 15px;">
                    –ó–∞–≥—Ä—É–∑–∏—Ç–µ JSON —Ñ–∞–π–ª —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞. –ú–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ –æ–¥–∏–Ω –ø—Ä–æ—Ñ–∏–ª—å, —Ç–∞–∫ –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ
                    —Å—Ä–∞–∑—É.
                </p>
                <input type="file" id="import-file-input" accept=".json"
                    style="width: 100%; padding: 10px; border: 2px dashed var(--border-color); border-radius: 4px; cursor: pointer;">
                <div id="import-preview"
                    style="margin-top: 15px; padding: 10px; background: var(--bg-primary); border-radius: 4px; display: none;">
                    <div style="font-weight: 500; margin-bottom: 5px;">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</div>
                    <div id="import-preview-text" style="color: var(--text-secondary); font-size: 0.9em;"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeImportModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-success" onclick="doImportProfiles()" id="import-btn" disabled>üì•
                    –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="column-animation.js"></script>
    <script src="app.js"></script>
</body>

</html>